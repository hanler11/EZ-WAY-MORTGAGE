<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Google tag (gtag.js) -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=AW-17604243227"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "AW-17604243227");

      // Enhanced ecommerce and conversion tracking
      function trackConversion(action, service = "") {
        gtag("event", action, {
          event_category: "conversion",
          event_label: service,
          value: 1,
        });
        console.log("Conversion tracked:", action, service);
      }

      function trackEngagement(action, element = "") {
        gtag("event", action, {
          event_category: "engagement",
          event_label: element,
        });
      }

      function trackFormProgress(step, field = "") {
        gtag("event", "form_progress", {
          event_category: "form",
          event_label: step + "_" + field,
          step: step,
        });
      }

      // Debugging - eliminar en producción
      console.log("Google Analytics initialized with ID: AW-17604243227");
    </script>

    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Contact EZ Way Mortgage</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="css/styles.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet" />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap"
      rel="stylesheet"
    />
    <!-- Calendly CSS -->
    <link
      href="https://assets.calendly.com/assets/external/widget.css"
      rel="stylesheet"
    />
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: { sans: ["Poppins", "sans-serif"] },
            colors: {
              'brand-blue': '#0f3a63',
              'brand-gold': '#b68c2f',
            },
          },
        },
      };
    </script>
    <style>
      body {
        font-family: "Poppins", sans-serif;
        overflow-x: hidden;
        margin: 0;
        padding: 0;
        scroll-behavior: smooth;
      }

      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      .sticky-nav-active {
        background-color: white;
        box-shadow: 0 6px 25px rgba(0, 0, 0, 0.2);
      }

      html {
        scroll-behavior: smooth;
        overflow-x: hidden;
        scroll-padding-top: 80px;
      }

      /* Mobile menu optimization */
      .mobile-menu-hidden {
        transform: translateY(-100%);
        opacity: 0;
        pointer-events: none;
        visibility: hidden;
      }

      .mobile-menu-visible {
        transform: translateY(0);
        opacity: 1;
        pointer-events: auto;
        visibility: visible;
      }

      .nav-menu-mobile {
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        background: white;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease-in-out;
        z-index: 10001;
        max-height: 100vh;
        overflow-y: auto;
      }

      .hamburger-icon {
        transition: transform 0.3s ease;
      }

      .hamburger-icon.active {
        transform: rotate(90deg);
      }

      /* Ocultar navbar cuando calculadora está abierta */
      .navbar-hidden {
        transform: translateY(-100%);
        opacity: 0;
        pointer-events: none;
      }

      /* Estilos para header de calculadora en responsive */
      .lhp-header {
        display: none;
      }

      /* Mostrar header con botón de cierre solo en mobile */
      @media (max-width: 768px) {
        .lhp-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          background: #b68c2f;
          color: white;
          padding: 12px 16px;
          font-weight: 600;
          position: sticky;
          top: 0;
          z-index: 10;
          border-radius: 16px 16px 0 0;
        }

        .lhp-header .calc-close {
          background: rgba(255, 255, 255, 0.2);
          border: none;
          color: white;
          font-size: 18px;
          width: 32px;
          height: 32px;
          border-radius: 50%;
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          transition: all 0.3s ease;
        }

        .lhp-header .calc-close:hover {
          background: rgba(255, 255, 255, 0.3);
          transform: scale(1.1);
        }

        .lhp-content {
          padding: 0 8px 8px 8px;
          border-radius: 0 0 16px 16px;
        }
      }

      .calendly-iframe {
        min-height: 600px;
        width: 100%;
        border: none;
        border-radius: 1rem;
        background: #f8fafc;
      }

      /* Estilos para la transición */
      .form-section,
      .calendly-section {
        transition: all 0.5s ease-in-out;
      }
      .hidden-section {
        opacity: 0;
        transform: translateY(20px);
        pointer-events: none;
      }
      .visible-section {
        opacity: 1;
        transform: translateY(0);
        pointer-events: auto;
      }

      /* (Calendly removido) */
    </style>

    <!-- Google tag (gtag.js) - COLOCADO CORRECTAMENTE AL FINAL DEL HEAD -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=AW-17604243227"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "AW-17604243227");

      // Enhanced ecommerce and conversion tracking
      function trackConversion(action, service = "") {
        gtag("event", action, {
          event_category: "conversion",
          event_label: service,
          value: 1,
        });
        console.log("Conversion tracked:", action, service);
      }

      function trackEngagement(action, element = "") {
        gtag("event", action, {
          event_category: "engagement",
          event_label: element,
        });
      }

      function trackFormProgress(step, field = "") {
        gtag("event", "form_progress", {
          event_category: "form",
          event_label: step + "_" + field,
          step: step,
        });
      }

      // Debugging - eliminar en producción
      console.log("Google Analytics initialized with ID: AW-17604243227");
    </script>
  </head>
  <body class="font-sans text-gray-800 bg-gray-50">
    <!-- Responsive Navbar -->
    <header
      id="navbar"
      class="fixed top-0 left-0 w-full z-50 transition-all bg-white shadow"
    >
      <div class="max-w-7xl mx-auto px-4 sm:px-6">
        <!-- Logo y Navegación -->
        <div class="flex items-center justify-between w-full h-20">
          <div
            class="flex flex-col min-w-0 flex-1 navbar-title-container"
          >
            <a href="index.html" class="flex items-center gap-2 sm:gap-3 group flex-shrink-0">
            <img
              src="assets/logoEZ.png"
              alt="EZ Way Mortgage Logo"
              class="h-10 sm:h-14 w-auto flex-shrink-0"
            />
            <span
              class="text-xs sm:text-lg font-bold text-brand-gold group-hover:text-black transition nowrap-visible"
              >EZ Way Mortgage Corporation</span>
          </a>
          <!-- NMLS Info debajo del logo -->
          <div class="text-xs text-gray-600 ml-4 sm:ml-6 mt-1">
            <span class="font-medium">NMLS #2679112</span>
            <span class="mx-1 hidden md:inline">•</span>
            <span class="hidden md:inline">Licensed Mortgage Brokerage</span>
          </div>
        </div>

        <button
          id="nav-toggle"
          class="md:hidden text-2xl text-brand-gold focus:outline-none relative z-50"
          aria-label="Abrir menú de navegación"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-8 w-8 transition-transform duration-300 hamburger-icon"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M4 8h16M4 16h16"
              class="hamburger-line"
            />
          </svg>
        </button>

        <!-- Desktop Navigation -->
        <nav
          class="hidden md:flex md:space-x-8 text-lg font-bold md:items-center"
          data-nav
        >
          <a
            href="index.html"
            data-link="home"
            class="hover:text-black transition"
            >Home</a
          >
          <a
            href="about.html"
            data-link="about"
            class="hover:text-black transition"
            >About</a
          >
          <a
            href="services.html"
            data-link="programs"
            class="hover:text-black transition"
            >Programs</a
          >
          <a
            href="index.html#how-it-works"
            data-link="process"
            class="hover:text-black transition"
            >Process</a
          >
          <a
            href="contact.html"
            data-link="contact"
            class="bg-brand-gold text-white font-semibold px-5 py-2 rounded hover:bg-black transition"
            >Get Pre-Approved</a
          >
        </nav>

        <!-- Mobile Navigation -->
        <nav id="nav-menu" class="nav-menu-mobile mobile-menu-hidden md:hidden">
          <div class="flex flex-col p-4 space-y-2" data-nav-mobile>
            <a
              href="index.html"
              data-link="home"
              class="px-4 py-3 block hover:bg-black/5 rounded transition"
              >Home</a
            >
            <a
              href="about.html"
              data-link="about"
              class="px-4 py-3 block hover:bg-black/5 rounded transition"
              >About</a
            >
            <a
              href="services.html"
              data-link="programs"
              class="px-4 py-3 block hover:bg-black/5 rounded transition"
              >Programs</a
            >
            <a
              href="index.html#how-it-works"
              data-link="process"
              class="px-4 py-3 block hover:bg-black/5 rounded transition"
              >Process</a
            >
            <a
              href="contact.html"
              data-link="contact"
              class="bg-brand-gold text-white font-semibold px-4 py-3 rounded hover:bg-black transition text-center mx-4 mt-2"
              >Get Pre-Approved</a
            >
          </div>
        </nav>
      </div>
    </header>

    <main class="pt-28 pb-16">
      <!-- Sección del Formulario -->
      <section
        id="form-section"
        class="max-w-5xl mx-auto bg-white rounded-2xl shadow-lg p-8 md:p-12 form-section visible-section"
        data-aos="fade-up"
      >
        <h2 class="text-3xl font-bold text-brand-blue mb-2 text-center">
          Start Your Pre-Approval
        </h2>
        <p class="text-gray-600 mb-8 text-center max-w-2xl mx-auto">
          Complete the secure form below and a licensed mortgage professional
          will follow up the same day.
        </p>
        <div
          class="rounded-lg p-6 mb-8 bg-gradient-to-r from-[#0f3a63]/5 to-[#0f3a63]/10 border border-brand-gold/30"
        >
          <strong class="block mb-2 text-brand-blue tracking-wide"
            >Quick Steps</strong
          >
          <ul class="list-disc list-inside text-gray-700 space-y-1 text-sm">
            <li>Fill all required fields accurately.</li>
            <li>We review income, assets and credit profile.</li>
            <li>Receive customized loan scenarios & rate ranges.</li>
            <li>Schedule a call or proceed to full application.</li>
          </ul>
        </div>
        <!-- Contact Form (Google Apps Script) -->
  <form id="contactForm" method="POST" action="https://script.google.com/macros/s/AKfycbxOnDjUy_a0zma3awobQztpAtdx-Rb_73QAr2iedKSKSS4eHKIgMZeUsLwXB03NeQ_q/exec" class="flex-1 space-y-4" data-aos="fade-right">
          <div class="flex gap-4">
            <div class="flex-1">
              <label for="name" class="block font-semibold mb-1">Full Name*</label>
              <input type="text" id="name" name="name" required class="w-full border rounded px-3 py-2" placeholder="Your Name" />
            </div>
            <div class="flex-1">
              <label for="email" class="block font-semibold mb-1">Email Address*</label>
              <input type="email" id="email" name="email" required class="w-full border rounded px-3 py-2" placeholder="Email Address" />
            </div>
          </div>
          <div class="flex gap-4">
            <div class="flex-1">
              <label for="phone" class="block font-semibold mb-1">Phone Number*</label>
              <input type="text" id="phone" name="phone" required class="w-full border rounded px-3 py-2" placeholder="Phone Number (e.g., 732-277-4547)" />
            </div>
          </div>
          <div>
            <label for="message" class="block font-semibold mb-1">Message</label>
            <textarea id="message" name="message" rows="4" class="w-full border rounded px-3 py-2" placeholder="Message (optional)"></textarea>
          </div>
          <!-- Campos ocultos para encabezados del email y destinatario -->
          <input type="hidden" id="to" name="to" value="Sofia@ezwaymortgages.com" />
          <input type="hidden" id="email_header" name="email_header" value="" />
          <input type="hidden" id="email_message_header" name="email_message_header" value="" />
          <button type="submit" id="submit-btn" class="btn-gold-primary w-full font-semibold px-6 py-3 rounded-md hover:scale-[1.02] transition">Send Message</button>
        </form>
  <p id="formStatus" class="text-center text-sm mt-4" role="status" aria-live="polite"></p>
      </section>

      <!-- (Calendly removido) -->
    </main>

    <!-- Footer -->
    <footer class="bg-[#0f3a63] text-gray-200 px-4 sm:px-6 py-12 border-t-4 border-[#b68c2f]">
      <div
        class="max-w-7xl mx-auto grid sm:grid-cols-2 lg:grid-cols-5 gap-10 text-sm"
      >
        <div
          class="flex flex-col items-center md:items-start text-center md:text-left"
        >
          <div class="mb-6 flex flex-col items-center gap-5">
            <a
              href="index.html"
              aria-label="Go to homepage"
              class="flex items-center gap-4 group"
            >
              <img
                src="assets/logoEZ.png"
                alt="EZ Way Mortgage Logo"
                class="h-14 w-auto group-hover:opacity-90 transition"
                loading="lazy"
              />
              <img
                src="assets/HE2.PNG"
                alt="Housing Equality"
                class="h-20 w-auto group-hover:opacity-90 transition"
                loading="lazy"
              />
            </a>
            <p class="text-gray-300 text-sm leading-snug max-w-xs">
              Licensed Mortgage Brokerage • Equal Housing Opportunity
            </p>
          </div>
        </div>
        <div>
          <h4 class="text-white font-semibold mb-3">Quick Links</h4>
          <ul class="space-y-2">
            <li>
              <a href="index.html" class="hover:underline text-gray-200"
                >Home</a
              >
            </li>
            <li>
              <a href="about.html" class="hover:underline text-gray-200"
                >About</a
              >
            </li>
            <li>
              <a href="services.html" class="hover:underline text-gray-200"
                >Programs</a
              >
            </li>
            <li>
              <a href="contact.html" class="hover:underline text-gray-200"
                >Contact</a
              >
            </li>
          </ul>
        </div>
        <div>
          <h4 class="text-white font-semibold mb-3">Loan Programs</h4>
          <ul class="space-y-2">
            <li>
              <a href="services.html" class="hover:underline text-gray-200"
                >Conventional (Purchase)</a
              >
            </li>
            <li>
              <a href="services.html" class="hover:underline text-gray-200"
                >FHA / VA / USDA</a
              >
            </li>
            <li>
              <a href="services.html" class="hover:underline text-gray-200"
                >Jumbo Loans</a
              >
            </li>
            <li>
              <a href="services.html" class="hover:underline text-gray-200"
                >Refinance Options</a
              >
            </li>
            <li>
              <a href="services.html" class="hover:underline text-gray-200"
                >HELOC & Equity</a
              >
            </li>
            <li>
              <a href="services.html" class="hover:underline text-gray-200"
                >No Income Verification (DSCR)</a
              >
            </li>
            <li>
              <a href="services.html" class="hover:underline text-gray-200"
                >Credit & Pre-Approval Coaching</a
              >
            </li>
          </ul>
        </div>
        <div>
          <h4 class="text-white font-semibold mb-3">Contact</h4>
          <ul class="space-y-2">
            <li>
              Email:
              <a
                href="mailto:Luis@ezwaymortgages.com"
                class="hover:underline text-gray-200"
                >Luis@ezwaymortgages.com</a
              >
            </li>
            <li>
              Phone:
              <a href="tel:7322774547" class="hover:underline text-gray-200"
                >732-277-4547</a
              >
            </li>
          </ul>
        </div>
        <div>
          <h4 class="text-white font-semibold mb-3">Follow Us</h4>
          <div class="flex justify-center space-x-6 mb-4">
            <a
              href="https://www.instagram.com/ezwaymortgage?utm_source=qr&igsh=MTY5ZXM3M3R2Z2txeg=="
              target="_blank"
              rel="noopener noreferrer"
              class="text-brand-gold hover:text-yellow-300 transition-colors duration-300 bg-[#0f3a63] p-3 rounded-full hover:bg-brand-gold border-2 border-brand-gold hover:border-yellow-300 social-link"
              aria-label="Instagram"
              onclick="window.open(this.href, '_blank'); return false;"
            >
              <img
                src="assets/instagram.png.avif"
                alt="Instagram"
                class="h-6 w-6 hover:scale-110 transition-transform duration-300"
                loading="lazy"
              />
            </a>
          </div>
          <div class="mt-6 text-center">
            <a
              href="contact.html"
              class="inline-block btn-gold-primary font-semibold px-5 py-2 rounded transition"
              >Get Pre-Approved</a
            >
          </div>
        </div>
      </div>
      <div class="text-center text-gray-400 text-sm mt-8 space-y-1">
        <div>&copy; 2025 EZ Way Mortgage Corporation. All rights reserved.</div>
        <div>NMLS # 2679112 | Loan Originator NMLS # 226951</div>
        <div class="text-xs max-w-2xl mx-auto leading-snug">
          EZ Way Mortgage Corporation is a Mortgage Broker licensed by the NJ
          Department of Banking and Insurance. This is not a commitment to lend.
          All loans subject to credit approval, underwriting guidelines and
          program availability. Equal Housing Opportunity.
        </div>
        <div class="text-xs italic">
          EZ Way Mortgage Corporation es un corredor hipotecario autorizado por
          el Departamento de Banca y Seguros de NJ.
        </div>
      </div>
    </footer>

    <style>
      /* Ocultar chat (Tawk.to) temporalmente */
      iframe[src*="tawk.to"],
      [id*="tawk"] {
        display: none !important;
        visibility: hidden !important;
      }
    </style>
    <!--Start of Tawk.to Script-->
    <script type="text/javascript">
      var Tawk_API = Tawk_API || {},
        Tawk_LoadStart = new Date();
      (function () {
        var s1 = document.createElement("script"),
          s0 = document.getElementsByTagName("script")[0];
        s1.async = true;
        s1.src = "https://embed.tawk.to/689be045609b391925b4cb51/1j2ge83q3";
        s1.charset = "UTF-8";
        s1.setAttribute("crossorigin", "*");
        s0.parentNode.insertBefore(s1, s0);
      })();
    </script>
    <!--End of Tawk.to Script-->

    <!-- (Calendly script removido) -->

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Track page view
        gtag("event", "page_view", {
          page_title: "Contact Us - EZ Way Mortgage",
          page_location: window.location.href,
        });

        // Highlight active nav
        (function () {
          function highlight() {
            const path =
              window.location.pathname.split("/").pop() || "index.html";
            const hash = window.location.hash;
            const map = {
              "index.html": "home",
              "about.html": "about",
              "services.html": "programs",
              "contact.html": "contact",
            };
            let key = map[path] || "home";
            if (path === "index.html" && hash.includes("how-it-works"))
              key = "process";
            const links = document.querySelectorAll(
              "[data-nav] [data-link], [data-nav-mobile] [data-link]"
            );
            links.forEach((a) =>
              a.classList.remove("text-brand-gold", "font-extrabold")
            );
            document.querySelectorAll(`[data-link="${key}"]`).forEach((a) => {
              if (!a.classList.contains("bg-brand-gold"))
                a.classList.add("text-brand-gold", "font-extrabold");
            });
          }
          highlight();
          window.addEventListener("hashchange", highlight);
        })();

        // Mobile menu toggle
        const navToggle = document.getElementById("nav-toggle");
        const navMenu = document.getElementById("nav-menu");
        const hamburgerIcon = navToggle?.querySelector("svg");

        if (navToggle && navMenu) {
          navToggle.addEventListener("click", (e) => {
            e.preventDefault();
            e.stopPropagation();

            const isHidden = navMenu.classList.contains("mobile-menu-hidden");

            if (isHidden) {
              navMenu.classList.remove("mobile-menu-hidden");
              navMenu.classList.add("mobile-menu-visible");
              hamburgerIcon?.classList.add("active");
            } else {
              navMenu.classList.remove("mobile-menu-visible");
              navMenu.classList.add("mobile-menu-hidden");
              hamburgerIcon?.classList.remove("active");
            }
          });

          // Close menu when clicking on links
          const navLinks = navMenu.querySelectorAll("a");
          navLinks.forEach((link) => {
            link.addEventListener("click", () => {
              navMenu.classList.remove("mobile-menu-visible");
              navMenu.classList.add("mobile-menu-hidden");
              hamburgerIcon?.classList.remove("active");
            });
          });

          // Close menu when clicking outside
          document.addEventListener("click", (e) => {
            if (!navToggle.contains(e.target) && !navMenu.contains(e.target)) {
              navMenu.classList.remove("mobile-menu-visible");
              navMenu.classList.add("mobile-menu-hidden");
              hamburgerIcon?.classList.remove("active");
            }
          });

          // Close menu on window resize to desktop
          window.addEventListener("resize", () => {
            if (window.innerWidth >= 768) {
              navMenu.classList.remove("mobile-menu-visible");
              navMenu.classList.add("mobile-menu-hidden");
            }
          });
        }

        // Sticky navbar
        let ticking = false;
        function updateNavbar() {
          const nav = document.getElementById("navbar");
          if (nav) {
            if (window.scrollY > 10) {
              nav.classList.add("sticky-nav-active");
            } else {
              nav.classList.remove("sticky-nav-active");
            }
          }
          ticking = false;
        }

        window.addEventListener(
          "scroll",
          () => {
            if (!ticking) {
              requestAnimationFrame(updateNavbar);
              ticking = true;
            }
          },
          { passive: true }
        );

        // Form tracking
  const form = document.getElementById("contactForm");
  const formFields = form ? form.querySelectorAll("input, select, textarea") : [];

        // Track form field interactions
        formFields.forEach((field) => {
          field.addEventListener("focus", () => {
            trackFormProgress("field_focus", field.name);
          });

          field.addEventListener("blur", () => {
            if (field.value.trim() !== "") {
              trackFormProgress("field_complete", field.name);
            }
          });
        });

        // (Loan Purpose removido) — omitimos el seguimiento de selección de servicio

        // Form and Calendly logic
    const formSection = document.getElementById("form-section");
    const submitBtn = document.getElementById("submit-btn");
    const formStatus = document.getElementById("formStatus");

        // (Calendly removido) Mostrar mensaje de éxito sencillo
        function showSuccess() {
          try {
            trackConversion("form_success", "contact_form");
          } catch (e) {}
          // Limpiar el formulario pero mantenerlo visible
          try {
            form.reset();
          } catch (e) {}

          const msg = document.createElement("div");
          msg.className = "mt-6 p-4 rounded bg-gray-50 border border-gray-300 text-black";
          msg.textContent = "Thank you! Your information has been sent. We'll contact you shortly.";
          formSection.appendChild(msg);
          formSection.scrollIntoView({ behavior: "smooth", block: "start" });
        }

        // Manejo del envío del formulario (Apps Script con respuesta de texto)
        form.addEventListener("submit", function (e) {
          e.preventDefault();

          // Track intento de envío
          try { trackFormProgress("form_submitted", "contact_form"); } catch (e) {}

          // Estado de carga del botón
          submitBtn.innerHTML = "Submitting...";
          submitBtn.disabled = true;

          const formData = new FormData(form);

          // Poblar encabezados solicitados con URL fija
          const fixedUrl = 'https://ezwaymortgages.com/index.html';
          const header = `nuevo formulario enviado desde tu web ${fixedUrl}`;
          const messageHeader = `nuevo mensaje enviado desde tu web: ${fixedUrl}`;
          const hiddenHeader = form.querySelector('#email_header');
          const hiddenMsgHeader = form.querySelector('#email_message_header');
          if (hiddenHeader) hiddenHeader.value = header;
          if (hiddenMsgHeader) hiddenMsgHeader.value = messageHeader;
          formData.set('email_header', header);
          formData.set('email_message_header', messageHeader);

          // (Revertido) No se agregan campos extra; se envía como antes

          // Enviar únicamente al Apps Script
          fetch(form.action + "?ts=" + Date.now(), {
            method: "POST",
            mode: "no-cors",
            body: formData,
          })
            .then(() => {
              // Respuesta opaca: asumimos éxito
              try { trackConversion("form_success", "contact_form"); } catch (e) {}
              if (formStatus) {
                formStatus.innerText = "Message sent successfully ✔️";
                formStatus.className = "text-black text-center text-sm mt-4";
              }
              try { form.reset(); } catch (e) {}
              formSection.scrollIntoView({ behavior: "smooth", block: "start" });
            })
            .catch((error) => {
              console.log("Apps Script error:", error);
              try { trackEngagement("form_error", "submission_failed"); } catch (e) {}
              if (formStatus) {
                formStatus.innerText = "Hubo un error al enviar ❌";
                formStatus.className = "text-red-700 text-center text-sm mt-4";
              }
            })
            .finally(() => {
              // Restaurar el botón
              submitBtn.innerHTML = "Send Message";
              submitBtn.disabled = false;
            });
        });

  // (Calendly removido)

        // Track navigation clicks
        document.querySelectorAll("nav a").forEach((link) => {
          link.addEventListener("click", () => {
            trackEngagement("navigation_click", link.textContent.trim());
          });
        });

        // (Calendly events removidos)
      });
    </script>

    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script>
      AOS.init({ duration: 1000, once: true });
    </script>
    <!-- Floating Calculator (shared) -->
    <button
      id="loan-btn"
      type="button"
      title="Loan calculator"
      aria-label="Open loan calculator"
      onclick="openLHPCalculator()"
    >
      <img 
        src="assets/Calculator.png?v=3" 
        alt="Calculator" 
      />
    </button>

    <div id="calculator" role="dialog" aria-label="Calculator">
      <div class="calc-header">
        <strong>Calculator</strong>
        <button class="calc-close" aria-label="Close calculator">✕</button>
      </div>
      <div class="display" id="calc-display">0</div>
      <div class="keys">
        <div class="calc-key clear">C</div>
        <div class="calc-key">(</div>
        <div class="calc-key">)</div>
        <div class="calc-key operator">÷</div>

        <div class="calc-key">7</div>
        <div class="calc-key">8</div>
        <div class="calc-key">9</div>
        <div class="calc-key operator">×</div>

        <div class="calc-key">4</div>
        <div class="calc-key">5</div>
        <div class="calc-key">6</div>
        <div class="calc-key operator">−</div>

        <div class="calc-key">1</div>
        <div class="calc-key">2</div>
        <div class="calc-key">3</div>
        <div class="calc-key operator">+</div>

        <div class="calc-key">0</div>
        <div class="calc-key">.</div>
        <div class="calc-key equals">=</div>
        <div class="calc-key">←</div>
      </div>
    </div>

    <!-- LHP Professional Calculator Modal -->
    <div
      id="lhp-calculator"
      role="dialog"
      aria-label="Professional loan calculator"
    >
      <div class="lhp-header">
        <strong>Professional Loan Calculator</strong>
        <button
          class="calc-close"
          aria-label="Close calculator"
          onclick="closeLHPCalculator()"
        >
          ✕
        </button>
      </div>
      <div class="lhp-content">
        <div id="lhp-calculator-content">
          <div class="calculator-loading text-center py-12">
            <div
              class="inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-brand-gold mb-4"
            ></div>
            <p class="text-gray-600">
              Loading professional calculator...
            </p>
          </div>
        </div>
      </div>
    </div>

    <script src="js/loan-calc.js"></script>
  </body>
  </html>
<!-- Dynamic chat suppression (defense-in-depth) -->
<script>
  (function () {
    function purgeChat() {
      const selectors = [
        'iframe[src*="tawk.to"]',
        'script[src*="tawk.to"]',
        'link[href*="tawk.to"]',
        'div[id*="tawk"]',
        'div[class*="tawk"]',
      ];
      selectors.forEach((sel) =>
        document.querySelectorAll(sel).forEach((n) => n.remove())
      );
    }
    purgeChat();
    const mo = new MutationObserver(purgeChat);
    mo.observe(document.documentElement, { childList: true, subtree: true });
    setInterval(purgeChat, 4000);
  })();
</script>
<script>
  (function () {
    const blocked = [/tawk\.to/i];
    const origCreate = Document.prototype.createElement;
    Document.prototype.createElement = function (tag) {
      const el = origCreate.call(this, tag);
      if (/script|iframe/i.test(tag)) {
        Object.defineProperty(el, "src", {
          set(v) {
            if (v && blocked.some((r) => r.test(v))) {
              console.debug("Blocked chat script", v);
            } else {
              el.setAttribute("src", v);
            }
          },
          get() {
            return el.getAttribute("src");
          },
        });
      }
      return el;
    };
    ["appendChild", "insertBefore"].forEach((fn) => {
      const o = Node.prototype[fn];
      Node.prototype[fn] = function (n) {
        try {
          const s = n && n.getAttribute && n.getAttribute("src");
          if (s && blocked.some((r) => r.test(s))) {
            console.debug("Prevented insertion", s);
            return n;
          }
        } catch (e) {}
        return o.apply(this, arguments);
      };
    });
    const style = document.createElement("style");
    style.textContent =
      '[id*="tawk"],[class*="tawk"],iframe[src*="tawk.to"]{display:none!important;visibility:hidden!important;opacity:0!important;}';
    document.documentElement.appendChild(style);
  })();
</script>
